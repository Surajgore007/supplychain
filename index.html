<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guardian AI | Ethical Risk Monitor</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Syncopate:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #050508;
            --panel: rgba(10, 10, 15, 0.9);
            --accent: #50ffaf;
            --warning: #ffaa00;
            --danger: #ff4545;
            --text: #f0f0f5;
            --glass: rgba(255, 255, 255, 0.03);
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Space Grotesk', sans-serif;
            margin: 0;
            overflow-x: hidden;
            background-image: radial-gradient(circle at 0% 0%, rgba(80, 255, 175, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 100% 100%, rgba(255, 69, 69, 0.03) 0%, transparent 50%);
        }

        .layout {
            display: grid;
            grid-template-columns: 380px 1fr;
            grid-template-rows: 90px 1fr;
            height: 100vh;
            gap: 20px;
            padding: 20px;
            box-sizing: border-box;
        }

        .panel {
            background: var(--panel);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 25px;
            position: relative;
        }

        header {
            grid-column: 1 / -1;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        h1 {
            font-family: 'Syncopate', sans-serif;
            font-size: 1.2rem;
            letter-spacing: 4px;
            margin: 0;
            color: var(--accent);
            text-shadow: 0 0 20px rgba(80, 255, 175, 0.3);
        }

        .input-area {
            display: flex;
            gap: 12px;
            background: rgba(255, 255, 255, 0.1);
            padding: 6px;
            border-radius: 12px;
        }

        input {
            background: transparent;
            border: none;
            color: white;
            padding: 10px 15px;
            width: 300px;
            outline: none;
            font-family: inherit;
        }

        button {
            background: var(--accent);
            color: black;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
            text-transform: uppercase;
            font-size: 0.8rem;
        }

        button:hover {
            box-shadow: 0 0 30px var(--accent);
            transform: translateY(-2px);
        }

        /* Integrity Gauge */
        .integrity-box {
            text-align: center;
            margin-bottom: 30px;
        }

        .gauge-circle {
            width: 150px;
            height: 150px;
            border: 8px solid var(--glass);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-top-color: var(--accent);
            transition: 1s;
        }

        .gauge-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent);
        }

        /* Metrics Grid */
        .metrics {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: var(--glass);
            padding: 12px;
            border-radius: 12px;
            text-align: center;
        }

        .metric-card label {
            display: block;
            font-size: 0.7rem;
            text-transform: uppercase;
            color: #888;
            margin-bottom: 5px;
        }

        .metric-card span {
            font-weight: 700;
            color: var(--text);
        }

        /* Violation Log */
        .violation-log {
            flex: 1;
            overflow-y: auto;
        }

        .violation-card {
            background: var(--glass);
            border-left: 3px solid var(--danger);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
        }

        .violation-type {
            color: var(--danger);
            font-weight: 700;
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        .violation-desc {
            font-size: 0.9rem;
            margin: 8px 0;
            color: #ccc;
        }

        .mitigation {
            font-size: 0.8rem;
            color: var(--accent);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            padding-top: 8px;
            margin-top: 8px;
        }

        /* Main Viewport */
        .main-stage {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        #visual-anchor {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        #visual-anchor img {
            max-width: 100%;
            border-radius: 12px;
            opacity: 0.8;
        }

        .status-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 0.8rem;
            border: 1px solid var(--accent);
            color: var(--accent);
        }

        /* Loader */
        #loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Syncopate', sans-serif;
            color: var(--accent);
        }

        .scanner {
            width: 300px;
            height: 2px;
            background: var(--accent);
            box-shadow: 0 0 20px var(--accent);
            animation: scanning 1.5s infinite ease-in-out;
        }

        @keyframes scanning {
            0% {
                opacity: 0.2;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.2;
            }
        }
    </style>
</head>

<body>

    <div id="loader">
        <div style="margin-bottom: 20px; letter-spacing: 5px;">SCANNING ETHICAL LAYER</div>
        <div class="scanner"></div>
    </div>

    <div class="layout">
        <header class="panel">
            <h1>REAL-TIME ETHICAL RISK MONITOR</h1>
            <div class="input-area">
                <input type="text" id="target-input" placeholder="SYSTEM ID (e.g. Recruitment AI Core)"
                    value="Neural-Recruiter v2.4">
                <button id="audit-btn">INITIATE AUDIT</button>
            </div>
        </header>

        <aside class="panel" style="display: flex; flex-direction: column;">
            <div class="integrity-box">
                <div class="gauge-circle" id="main-gauge">
                    <div class="gauge-value" id="integrity-value">--</div>
                </div>
                <div style="font-size: 0.8rem; color: #888; text-transform: uppercase;">Overall System Integrity</div>
            </div>

            <div class="metrics">
                <div class="metric-card"><label>Bias</label><span id="bias-val">--</span></div>
                <div class="metric-card"><label>Fairness</label><span id="fairness-val">--</span></div>
                <div class="metric-card"><label>Privacy</label><span id="privacy-val">--</span></div>
            </div>

            <div class="violation-log" id="violation-log">
                <div style="text-align: center; color: #555; margin-top: 50px;">Waiting for audit link...</div>
            </div>
        </aside>

        <main class="main-stage">
            <div id="visual-anchor">
                <div class="status-overlay" id="status-text">INITIAL STAGING</div>
                <img id="audit-img" src="" style="display: none;">
                <div style="color: #444; font-size: 1.2rem; font-weight: 300;">INTEGRITY MONITOR STANDBY</div>
            </div>

            <div class="panel" style="flex: 0.2;">
                <div id="summary-text" style="color: #bbb; line-height: 1.6;">Enter enterprise AI system parameters to
                    begin real-time ethical drift analysis.</div>
            </div>
        </main>
    </div>

    <script>
        const btn = document.getElementById('audit-btn');
        const input = document.getElementById('target-input');
        const loader = document.getElementById('loader');

        async function performAudit() {
            const target = input.value.trim();
            if (!target) return;

            loader.style.display = 'flex';

            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ target })
                });

                if (!response.ok) throw new Error("Audit Link Severed");
                const data = await response.json();

                updateDashboard(data);
            } catch (err) {
                alert(err.message);
            } finally {
                loader.style.display = 'none';
            }
        }

        function updateDashboard(data) {
            // Update Gauge
            document.getElementById('integrity-value').innerText = data.overall_integrity + '%';
            const gauge = document.getElementById('main-gauge');
            const intensity = 100 - data.overall_integrity;
            gauge.style.borderTopColor = data.overall_integrity > 70 ? '#50ffaf' : (data.overall_integrity > 40 ? '#ffaa00' : '#ff4545');
            gauge.style.boxShadow = `0 0 40px ${gauge.style.borderTopColor}22`;

            // Update Metrics
            document.getElementById('bias-val').innerText = data.metrics.bias_score + '%';
            document.getElementById('fairness-val').innerText = data.metrics.fairness_level + '%';
            document.getElementById('privacy-val').innerText = data.metrics.privacy_integrity + '%';

            // Update Status
            const statusEl = document.getElementById('status-text');
            statusEl.innerText = 'STATUS: ' + data.risk_status;
            statusEl.style.color = gauge.style.borderTopColor;
            statusEl.style.borderColor = gauge.style.borderTopColor;

            // Update Violations
            const log = document.getElementById('violation-log');
            log.innerHTML = '';
            data.violations.forEach(v => {
                const card = document.createElement('div');
                card.className = 'violation-card';
                if (v.severity === 'Critical') card.style.borderLeftColor = '#ff4545';
                else if (v.severity === 'High') card.style.borderLeftColor = '#ffaa00';
                else card.style.borderLeftColor = '#50ffaf';

                card.innerHTML = `
                <div class="violation-type">${v.type} (${v.severity})</div>
                <div style="font-size: 0.7rem; color: #888;">Comp: ${v.component}</div>
                <div class="violation-desc">${v.description}</div>
                <div class="mitigation"><strong>Mitigation:</strong> ${v.mitigation}</div>
            `;
                log.appendChild(card);
            });

            // Update Visual via Pollinations
            const visualImg = document.getElementById('audit-img');
            const visualPrompt = encodeURIComponent(data.visual_prompt || "AI Ethics Monitor Shield");
            visualImg.src = `https://image.pollinations.ai/prompt/${visualPrompt}?width=1000&height=600&model=flux&nologo=true`;
            visualImg.style.display = 'block';
            visualImg.previousElementSibling.style.display = 'none'; // hide placeholder text
        }

        btn.addEventListener('click', performAudit);
    </script>

</body>

</html>